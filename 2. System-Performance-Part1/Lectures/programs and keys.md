Утилита `top` в Linux (Oracle Enterprise Linux 8) представляет собой мощный инструмент мониторинга системных ресурсов в режиме реального времени. Она отображает различные сведения о системе, такие как использование процессора, памяти, и другие важные параметры.

### Основные функции и параметры `top`

1. **Запуск утилиты:** `top`
2. **Основные поля:**
    - **PID**: Идентификатор процесса.
    - **USER**: Пользователь, которому принадлежит процесс.
    - **PR**: Приоритет процесса.
    - **NI**: Значение nice для процесса.
    - **VIRT**: Объем виртуальной памяти, используемой процессом.
    - **RES**: Объем резидентной памяти, используемой процессом.
    - **SHR**: Объем разделяемой памяти.
    - **S**: Состояние процесса (например, спящий, запущенный и т.д.).
    - **%CPU**: Процент использования процессора процессом.
    - **%MEM**: Процент использования оперативной памяти процессом.
    - **TIME+**: Общее время CPU, использованное процессом.
    - **COMMAND**: Имя команды или процесса.
3. **Основные команды внутри `top`:**
    - **h** или **?**: Показать справку.
    - **k**: Убить процесс (потребует указать PID).
    - **q**: Выйти из `top`.
    - **z**: Включить/выключить цветной режим.
    - **r**: Изменить приоритет (ренайсить) процесс.
    - **P**: Сортировать по загрузке процессора.
    - **M**: Сортировать по использованию памяти.
    - **N**: Сортировать по PID.
    - **T**: Сортировать по времени процессора.
4. **Фильтрация и сортировка:**
    - Нажмите **O** (англ. буква O) для сортировки по другим полям. Введите имя поля для сортировки.
    - **u**: Показать процессы конкретного пользователя.
5. **Настройка отображения:**
    - **1**: Показать информацию о каждом ядре процессора.
    - **f**: Настроить отображаемые поля.
    - **W**: Сохранить настройки в конфигурационный файл.
6. **Выход из `top`:**
    - Нажмите **q** для выхода.

### Примеры использования:

1. **Запуск `top` с обновлением каждые 5 секунд:**
    
    ```bash
    top -d 5
    ```
    
- **Запуск `top` с отображением только процессов определенного пользователя:**
    
    ```bash
    top -u username
    ```
    
- **Запуск `top` с выводом результатов в batch-режиме (без интерактивного интерфейса):**
    
    ```bash
    top -b -n 1
    ```
    

Эти команды и параметры помогут эффективно использовать утилиту `top` для мониторинга и управления процессами в системе.

Утилита `top` в Linux предоставляет множество возможностей для сортировки и настройки отображаемой информации. Ниже приведены детали о различных способах сортировки, дополнении заголовков и сортировке по использованию SWAP.

### Сортировка процессов

1. **Сортировка по использованию процессора (CPU):**
    - Нажмите `P` в интерактивном режиме `top`, чтобы сортировать процессы по убыванию использования процессора.
2. **Сортировка по использованию памяти (Memory):**
    - Нажмите `M` для сортировки по убыванию использования памяти.
3. **Сортировка по времени процессора (TIME+):**
    - Нажмите `T` для сортировки по времени, использованному процессором.
4. **Сортировка по PID (Process ID):**
    - Нажмите `N` для сортировки по PID.
5. **Сортировка по имени команды (COMMAND):**
    - Нажмите `C` для сортировки по имени команды.
6. **Сортировка по другим полям:**
    - Нажмите `O` (англ. буква O) и введите имя поля, по которому хотите сортировать. Например, для сортировки по `SWAP`, введите `k` (англ. буква k).

### Дополнение заголовков

Для настройки отображаемых заголовков и полей можно использовать следующие команды:

1. **Отображение всех доступных полей:**
    - Нажмите `f` для входа в режим настройки отображаемых полей. Вы увидите список всех доступных полей.
2. **Включение/выключение полей:**
    - Используйте стрелки вверх и вниз для навигации по списку полей.
    - Нажмите `d` для включения или выключения выбранного поля.
3. **Сохранение настроек:**
    - Нажмите `W` для сохранения настроек в конфигурационный файл `.toprc` в вашем домашнем каталоге.

### Сортировка по SWAP

Сортировка по использованию SWAP полезна для выявления процессов, активно использующих подкачку. Вот как это сделать:

1. **Запуск `top`:**
    
    ```bash
    `top`
    ```
    
2. **Вход в режим настройки полей:**
    - Нажмите `f`.
3. **Включение поля SWAP:**
    - Используйте стрелки для навигации к полю `SWAP` и нажмите `d`, чтобы включить его.
4. **Выход из режима настройки полей:**
    - Нажмите `Esc` для возврата к основному экрану `top`.
5. **Сортировка по полю SWAP:**
    - Нажмите `O` (англ. буква O), затем `k` для выбора поля `SWAP` для сортировки.

### Примеры команд

1. **Сортировка по SWAP:**
2. Откройте `top`:
3. Добавляем колонку с SWAP нажатием `f + p + Enter`
4. Нажмите `Shift + o` (большая буква O).
5. Нажмите `p` (маленькая буква p).

Теперь ваши процессы должны быть отсортированы по использованию SWAP в порядке убывания.

---

---

---

# Команда atop

Утилита `atop` - это продвинутый системный монитор, который предоставляет подробную информацию о производительности системы, включая использование процессора, памяти, дисков, сетевых интерфейсов и процессов. Она полезна для системных администраторов, которые хотят отслеживать и анализировать производительность системы в реальном времени или записывать данные для последующего анализа.

Вот некоторые ключи и их полезные функции в утилите `atop`:

1. **Основные ключи запуска:**
    - `atop` без параметров: Запуск в интерактивном режиме, отображение текущих значений производительности системы.
    - `atop -r <file>`: Чтение ранее записанного файла данных производительности.
    - `atop -w <file>`: Запись текущих данных производительности в файл.
2. **Ключи фильтрации и отображения:**
    - `c`: Показать командные строки для процессов.
    - `m`: Показать информацию о памяти (использование памяти процессами).
    - `d`: Показать информацию о дисках (использование дисков процессами).
    - `n`: Показать сетевую информацию (использование сети процессами).
    - `s`: Показать своп-память.
    - `y`: Показать системные вызовы.
3. **Ключи для более детализированного анализа:**
    - `p`: Показать информацию о процессах (процессоры, используемые каждым процессом).
    - `u`: Показать информацию об использовании процессора (по процессорам и по процессам).
    - `v`: Показать информацию о виртуальной памяти.
    - `a`: Показать все процессы (включая завершенные процессы с момента последнего запуска `atop`).
4. **Другие полезные ключи:**
    - `R`: Показать только суммарную информацию по системным ресурсам.
    - `P`: Показать информацию по отдельным процессорам.
    - `G`: Показать информацию по группам процессов.
    - `T`: Показать информацию о процессах, связанных с терминалами.
5. **Примеры использования:**
    - `atop -w /var/log/atop.log 60`: Запись данных производительности каждые 60 секунд в файл.
    - `atop -r /var/log/atop.log`: Просмотр записанных данных из файла.

Эти ключи позволяют адаптировать `atop` под конкретные нужды администратора, будь то мониторинг в реальном времени или анализ записанных данных для выявления проблем производительности.

В утилите atop, используемой для мониторинга производительности системы в реальном времени, каждая колонка имеет определенное значение:

- **PID**: Идентификатор процесса.
- **SYSCPU**: Время процессора, затраченное на выполнение системного (ядрового) кода для конкретного процесса.
- **USRCPU**: Время процессора, затраченное на выполнение пользовательского кода для конкретного процесса.
- **RDELAY**: Задержка времени чтения ввода/вывода (I/O read delay).
- **BDELAY**: Задержка времени блокировки ввода/вывода (I/O block delay).
- **VGROW**: Изменение виртуального размера памяти процесса (VIRT).
- **RGROW**: Изменение резидентного размера памяти процесса (RES).
- **RDDSK**: Количество прочитанных данных с диска для конкретного процесса.
- **WRDSK**: Количество записанных данных на диск для конкретного процесса.
- **RUID**: Реальный идентификатор пользователя, который запустил процесс.
- **EUID**: Эффективный идентификатор пользователя, под которым выполняется процесс.
- **ST**: Состояние процесса (например, R для работающего, S для спящего и т.д.).
- **EXC**: Исключения, возникшие для процесса.
- **THR**: Количество потоков в процессе.
- **S**: Состояние процесса (то же, что и **ST**).
- **CPUNR**: Номер процессорного ядра, на котором выполняется процесс.
- **CPU**: Суммарная загрузка процессора для процесса.
- **CMD**: Команда, с которой был запущен процесс.

---

- **NPROCS**: Количество процессов.
- **SYSCPU**: Время процессора, затраченное на выполнение системного (ядрового) кода.
- **USRCPU**: Время процессора, затраченное на выполнение пользовательского кода.
- **VSIZE**: Виртуальный размер памяти процесса.
- **RSIZE**: Резидентный размер памяти процесса (в физической памяти).
- **PSIZE**: Размер памяти процесса на диске (размер занимаемого swap).
- **LOCKSZ**: Размер заблокированной (locked) памяти.
- **SWAPSZ**: Размер используемого swap пространства.
- **RDDSK**: Количество прочитанных данных с диска.
- **WRDSK**: Количество записанных данных на диск.
- **RNET**: Объем полученных данных через сеть.
- **SNET**: Объем отправленных данных через сеть.
- **CPU**: Суммарная загрузка процессора.

---

# **Команда atopsar**

Команда `atopsar` — это встроенный анализатор логов `atop`, который позволяет быстро найти проблему и анализировать логи за нужный период времени. Она предоставляет множество ключей для фильтрации и отображения информации о различных аспектах системы.

### Основные ключи и параметры `atopsar`

1. **Указание временного интервала:**
    - **b** — начало периода:

`atopsar -b HH:MM`

- **e** — конец периода:

`atopsar -e HH:MM`

- **Поиск отдельных процессов:**
    - **O** — top-3 процессов по использованию CPU:

`atopsar -O`

- **G** — top-3 процессов по использованию RAM:

`atopsar -G`

- **D** — top-3 процессов по использованию диска:

`atopsar -D`

- **N** — top-3 процессов по использованию сети:

`atopsar -N`

- **Общая нагрузка:**
    - **d** — нагрузка на каждый диск отдельно:

`atopsar -d`

- **m** — нагрузка на оперативную память и swap:

`atopsar -m`

- **с** — нагрузка на процессор, отдельно по каждому ядру:

`atopsar -c`

- **p** — количество процессов и тредов:

`atopsar -p`

- **w** — нагрузка на IPv4:

`atopsar -w`

- **W** — ошибки на IPv4:

`atopsar -W`

- **i** — нагрузка на интерфейс:

`atopsar -i`

### Примеры использования

1. **Вывод лога с 10:00 до 12:00:**

`atopsar -b 10:00 -e 12:00`

- **Поиск top-3 процессов по использованию CPU:**

`atopsar -O`

- **Поиск top-3 процессов по использованию RAM:**

`atopsar -G`

- **Анализ нагрузки на каждый диск отдельно:**

`atopsar -d`

- **Анализ нагрузки на оперативную память и swap:**

`atopsar -m`

- **Анализ нагрузки на процессор по каждому ядру:**

`atopsar -c`

- **Анализ нагрузки на интерфейс:**

`atopsar -i`

Эти команды и параметры позволят вам эффективно использовать `atopsar` для анализа логов и мониторинга системы в нужный вам период времени.

---

---

---

Команда `mpstat` используется для мониторинга загрузки процессоров и предоставления отчета о их использовании. Она предоставляет различные ключи и параметры для вывода подробной информации о состоянии процессоров в системе. Рассмотрим подробнее ключи и параметры команды `mpstat`.

### Основные ключи и параметры `mpstat`

1. **A** — выводит всю возможную информацию о процессорах и всю возможную информацию команды `mpstat`:
    
    ```
    mpstat -A
    ```
    

Этот ключ выводит подробную информацию обо всех аспектах работы процессоров, включая использование процессора, прерывания, контекстные переключения и т.д.

- **P** — выводит информацию по индивидуальным процессорам или ядрам:
    
    ```
    mpstat -P ALL
    ```
    
- `ALL` — показывает статистику по всем процессорам.
- `{0..n}` — указывает конкретные процессоры или ядра, где `n` — номер процессора.

### Дополнительные параметры и примеры

1. **Вывод информации по всем процессорам:**
    
    ```
    mpstat -P ALL
    ```
    
- **Вывод информации по конкретному процессору (например, процессору 0):**
    
    ```
    mpstat -P 0
    ```
    
- **Вывод всей возможной информации о процессорах:**
    
    ```
    mpstat -A
    ```
    

### Пример вывода `mpstat -P ALL`

```bash
$ mpstat -P ALL
Linux 4.15.0-142-generic (hostname)   05/25/2024  _x86_64_  (8 CPU)

02:00:01 PM  CPU    %usr   %nice    %sys  %iowait   %irq   %soft   %steal  %guest  %idle
02:00:01 PM  all    5.12    0.00    1.26     0.10   0.00    0.02     0.00    0.00  93.49
02:00:01 PM    0    5.13    0.00    1.27     0.10   0.00    0.02     0.00    0.00  93.48
02:00:01 PM    1    5.10    0.00    1.25     0.10   0.00    0.02     0.00    0.00  93.52
02:00:01 PM    2    5.12    0.00    1.26     0.10   0.00    0.02     0.00    0.00  93.49
02:00:01 PM    3    5.13    0.00    1.27     0.10   0.00    0.02     0.00    0.00  93.48
02:00:01 PM    4    5.11    0.00    1.26     0.10   0.00    0.02     0.00    0.00  93.51
02:00:01 PM    5    5.10    0.00    1.25     0.10   0.00    0.02     0.00    0.00  93.52
02:00:01 PM    6    5.12    0.00    1.26     0.10   0.00    0.02     0.00    0.00  93.49
02:00:01 PM    7    5.11    0.00    1.26     0.10   0.00    0.02     0.00    0.00  93.51

```

### Пояснение полей в выводе

- **%usr** — процент времени, затраченного на выполнение пользовательских процессов.
- **%nice** — процент времени, затраченного на выполнение процессов с низким приоритетом.
- **%sys** — процент времени, затраченного на выполнение системных процессов.
- **%iowait** — процент времени, затраченного на ожидание операций ввода/вывода.
- **%irq** — процент времени, затраченного на обработку аппаратных прерываний.
- **%soft** — процент времени, затраченного на обработку программных прерываний.
- **%steal** — процент времени, украденного гипервизором в виртуализированных средах.
- **%guest** — процент времени, затраченного на выполнение процессов гостей в виртуализированных средах.
- **%idle** — процент времени простоя.
